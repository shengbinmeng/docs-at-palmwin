当前网络控制模块策略的理解

（对应之前周超写的文档）

# 带宽上下限的估计

带宽的意义是传输的一段数据量除以这段数据的传输时间。

算法选取相邻的两个数据包p1和p2，用p2的大小作为数据量，用p2与p1的*接收时间戳之差*作为传输时间，相除之后得到a。

算法认为a是带宽上限。// 这涉及带宽的绝对值，但却是没有意义的。上述时间戳之差怎能认为是p2这段数据的传输时间呢？

下限为上限的0.8倍。// 其实上下限的作用甚微。

# 具体带宽的估计

 这其实就是对码率如何调整做决策。这部分采用了增量方法，用数据包传输时间的变化来估计带宽的变化，从而决定发送码率该如何调整。

基本思想是：传输时间变长（增量为正），则认为带宽变低，应该下调码率；反之上调。

这里的传输时间用每个数据包收发时间戳之差来计算。// 目前的实现里这个差并不是传输时间；但这个差的增量确是传输时间的增量，只用增量的话倒也说的通。

将增量用比值来描述，最终转化为码率应该调整的比例（可正可负），乘以已有码率，得到下一码率。

# 动态改变码率调整的频度

基本思想是：如果发现连着几次都在上调（或下调），就把调整频度增大（即把调整间隔减小），以求更快地上调至目标；反之减小频度。

（文档里写的“粒度”，实际值的是时间上的粒度，即如上所述的调整频度；每次调整时对码率幅值进行量化的粒度是另一个概念。）

# 丢包率的计算

直接计算未收到的包在总的发送包中所占的比例。

# 切换传输方式

基本思想是：如果当前传输方式A效果不好，则换成另一种传输方式B。

“效果不好”的判定：最近连续在用A，但现在发现传输状况不佳了；或者之前用的方式B，但现在发现用A后传输状况变差了。

“传输状况不佳”：丢包率大于阈值、码率低于阈值、RTT长于阈值；
“传输状况变差”：丢包率比之前更大、码率比之前更低、RTT比之前更长。
