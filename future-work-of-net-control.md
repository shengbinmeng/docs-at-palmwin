后续工作的考虑

# 当前方法的优化改进

目前发送时间和接收时间用了各自机器上的不同时间基准，可改为以共同的世界时间为基准。

服务器也用世界时间来进行决策，如此才能保证*时效性*。而且这样可得到具有实际物理意义的量，增加决策可用的信息。

# 试着从综合的角度采用控制论方法

基本思路：

- 用一个向量描述系统的状态，称为过程量；
- 确定系统的理想状态及其对应的量，作为目标量；
- 过程量与目标量之间的差值，称为误差量；
- 根据误差量的当前值、历史值、未来趋势三方面进行综合考虑，来对系统进行调整，使误差量趋于最小。

# 新增功能和需求点

控制端到端延迟；当前的系统似乎没有对延迟进行控制。

能够根据应用场景对控制策略进行定制（类似编码中的preset）。

- 直播时的策略：延迟可以稍大些，但要保证质量平滑。
- 两人通话时的策略：延迟不能太大，质量可以不那么平滑，但要流畅（不卡顿）。

# 评测指标

- 流畅度高：持续传输和解码，不卡顿；实现手段是低码率、保证数据完好；
- 清晰度高：画面质量好；实现手段为高码率。
- 平滑度高：清晰度不要变化太频繁和剧烈；实现手段：1. 保持低码率；2. 增大缓冲区。
- 延迟低：接收方播放的画面与发送方实际事件发生的时间相距不远；实现手段：减小缓冲区。

这些指标是互相影响的，需要统一考虑。

# 系统的可调整量

- 编码码率
- FEC的冗余度
- 传输方式
- 送给编码器的视频源 // 整个丢掉或快进一段儿以消除延迟？即编码前丢帧或调整帧率。
- 编码器参考帧结构（内部缓冲的帧）
- 发送数据前的缓冲区 // 数据准备好后，立即发送？网络不好时，不要急着发，可以先存2秒或500k的数据，待会儿再发嘛。
- 接收数据后的缓冲区 // 即播放缓冲区，增大该缓冲区可减少卡顿。但所有缓冲区都会带来延时。

目前前三个是可由网络控制模块直接调整的。进一步区分哪些是一次性配置的，那些是运行中可在线调整的。